import XCTest
import NaCl

final class NaClTests: XCTestCase {
    
    func testCorrectPublicKeyEd25519() {
        // given
        let sut = NaCl()

        // when
        let pk = sut.toPublic([
            16, 178, 107, 168, 184, 239, 81, 1,
            49, 250, 234, 11, 174, 27, 1, 108,
            23, 246, 114, 1, 193, 56, 223, 137,
            113, 181, 94, 154, 117, 201, 243, 79,
            249, 182, 69, 243, 125, 134, 50, 245,
            81, 249, 183, 101, 47, 102, 22, 194,
            121, 58, 252, 157, 240, 192, 43, 191,
            218, 208, 190, 43, 237, 237, 198, 110
        ]
        )

        // then
        let expectatedPk: [UInt8] = [
            25, 246, 193, 79, 157, 24, 20, 38,
            58, 18, 37, 16, 148, 122, 114, 189,
            31, 109, 125, 139, 89, 242, 233, 194,
            16, 211, 30, 24, 212, 195, 9, 175
        ]
        XCTAssertEqual(pk, expectatedPk)
    }
}
